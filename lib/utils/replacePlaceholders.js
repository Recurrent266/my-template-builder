"use strict";
// Â© 2024 Amazon Web Services, Inc. or its affiliates.
// All Rights Reserved. This AWS Content is provided subject to the terms of
// the AWS Customer Agreement available at <http://aws.amazon.com/agreement>
// or other written agreement between Customer and either
// Amazon Web Services, Inc. or Amazon Web Service EMEA SARL or both.
// Copyright 2024 Amazon.com and its affiliates; all rights reserved.
// This file is Amazon Web Services Content and may not be duplicated
// or distributed without permission.
Object.defineProperty(exports, "__esModule", { value: true });
exports.copyFilesAndFolders = exports.deleteFolder = exports.renameFile = exports.replaceInFile = void 0;
const fs = require("node:fs");
const path = require("node:path");
const replaceInFile = (filePath, replacements) => {
    let content = fs.readFileSync(filePath, 'utf-8');
    replacements.forEach(([regex, replacement]) => {
        content = content.replace(regex, replacement);
    });
    fs.writeFileSync(filePath, content);
};
exports.replaceInFile = replaceInFile;
const renameFile = (filePath, newFilePath) => {
    fs.renameSync(filePath, newFilePath);
};
exports.renameFile = renameFile;
const deleteFolder = (folderPath) => {
    if (fs.existsSync(folderPath)) {
        fs.rmSync(folderPath, { recursive: true, force: true });
    }
};
exports.deleteFolder = deleteFolder;
const copyFilesAndFolders = (sourcePath, destinationPath, projectName) => {
    const LOWER_PROJECT_NAME = projectName.charAt(0).toLowerCase() + projectName.slice(1);
    const UPPER_PROJECT_NAME = projectName.charAt(0).toUpperCase() + projectName.slice(1);
    // Create the destination directory if it doesn't exist
    if (!fs.existsSync(destinationPath)) {
        fs.mkdirSync(destinationPath, { recursive: true });
    }
    // Read all files and directories in the source path
    const FILES = fs.readdirSync(sourcePath);
    for (const FILE of FILES) {
        const SRC_PATH = path.join(sourcePath, FILE);
        const STATS = fs.statSync(SRC_PATH);
        if (STATS.isDirectory()) {
            let newFolderPath;
            if (FILE.includes('${app}')) {
                const NEW_FOLDER_NAME = FILE.replace('${app}', LOWER_PROJECT_NAME);
                newFolderPath = path.join(destinationPath, NEW_FOLDER_NAME);
                (0, exports.deleteFolder)(newFolderPath); // Delete the existing folder
                fs.mkdirSync(newFolderPath, { recursive: true });
                (0, exports.copyFilesAndFolders)(SRC_PATH, newFolderPath, projectName);
            }
            else {
                const FOLDER_PATH = path.join(destinationPath, FILE);
                (0, exports.deleteFolder)(FOLDER_PATH); // Delete the existing folder
                fs.mkdirSync(FOLDER_PATH, { recursive: true });
                (0, exports.copyFilesAndFolders)(SRC_PATH, FOLDER_PATH, projectName);
            }
        }
        else if (STATS.isFile()) {
            let newFilePath;
            if (FILE.includes('${app}')) {
                newFilePath = path.join(destinationPath, FILE.replace('${app}', LOWER_PROJECT_NAME));
            }
            else {
                newFilePath = path.join(destinationPath, FILE);
            }
            const TEMP_FILE_PATH = path.join(destinationPath, `temp_${FILE}`);
            fs.copyFileSync(SRC_PATH, TEMP_FILE_PATH);
            (0, exports.replaceInFile)(TEMP_FILE_PATH, [
                [/\${name}/g, LOWER_PROJECT_NAME],
                [/\${Name}/g, UPPER_PROJECT_NAME],
            ]);
            if (fs.existsSync(newFilePath)) {
                fs.unlinkSync(newFilePath); // Delete the existing file
            }
            fs.copyFileSync(TEMP_FILE_PATH, newFilePath);
            (0, exports.renameFile)(TEMP_FILE_PATH, newFilePath);
        }
    }
};
exports.copyFilesAndFolders = copyFilesAndFolders;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwbGFjZVBsYWNlaG9sZGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9yZXBsYWNlUGxhY2Vob2xkZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxzREFBc0Q7QUFDdEQsNEVBQTRFO0FBQzVFLDRFQUE0RTtBQUM1RSx5REFBeUQ7QUFDekQscUVBQXFFO0FBQ3JFLHFFQUFxRTtBQUNyRSxxRUFBcUU7QUFDckUscUNBQXFDOzs7QUFFckMsOEJBQThCO0FBQzlCLGtDQUFrQztBQUUzQixNQUFNLGFBQWEsR0FBRyxDQUMzQixRQUFnQixFQUNoQixZQUFxQyxFQUNyQyxFQUFFO0lBQ0YsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDakQsWUFBWSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLFdBQVcsQ0FBQyxFQUFFLEVBQUU7UUFDNUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLFdBQVcsQ0FBQyxDQUFDO0lBQ2hELENBQUMsQ0FBQyxDQUFDO0lBQ0gsRUFBRSxDQUFDLGFBQWEsQ0FBQyxRQUFRLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDdEMsQ0FBQyxDQUFDO0FBVFcsUUFBQSxhQUFhLGlCQVN4QjtBQUVLLE1BQU0sVUFBVSxHQUFHLENBQUMsUUFBZ0IsRUFBRSxXQUFtQixFQUFFLEVBQUU7SUFDbEUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxRQUFRLEVBQUUsV0FBVyxDQUFDLENBQUM7QUFDdkMsQ0FBQyxDQUFDO0FBRlcsUUFBQSxVQUFVLGNBRXJCO0FBRUssTUFBTSxZQUFZLEdBQUcsQ0FBQyxVQUFrQixFQUFFLEVBQUU7SUFDakQsSUFBSSxFQUFFLENBQUMsVUFBVSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDOUIsRUFBRSxDQUFDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsRUFBRSxT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QWMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxRQUFRLElBQUksRUFBRSxDQUFDLENBQUM7WUFDbEUsRUFBRSxDQUFDLFlBQVksQ0FBQyxRQUFRLEVBQUUsY0FBYyxDQUFDLENBQUM7WUFFMUMsSUFBQSxxQkFBYSxFQUFDLGNBQWMsRUFBRTtnQkFDNUIsQ0FBQyxXQUFXLEVBQUUsa0JBQWtCLENBQUM7Z0JBQ2pDLENBQUMsV0FBVyxFQUFFLGtCQUFrQixDQUFDO2FBQ2xDLENBQUMsQ0FBQztZQUVILElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDO2dCQUMvQixFQUFFLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsMkJBQTJCO1lBQ3pELENBQUM7WUFFRCxFQUFFLENBQUMsWUFBWSxDQUFDLGNBQWMsRUFBRSxXQUFXLENBQUMsQ0FBQztZQUM3QyxJQUFBLGtCQUFVLEVBQUMsY0FBYyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBQzFDLENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBL0RXLFFBQUEsbUJBQW1CLHVCQStEOUIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyDCqSAyMDI0IEFtYXpvbiBXZWIgU2VydmljZXMsIEluYy4gb3IgaXRzIGFmZmlsaWF0ZXMuXG4vLyBBbGwgUmlnaHRzIFJlc2VydmVkLiBUaGlzIEFXUyBDb250ZW50IGlzIHByb3ZpZGVkIHN1YmplY3QgdG8gdGhlIHRlcm1zIG9mXG4vLyB0aGUgQVdTIEN1c3RvbWVyIEFncmVlbWVudCBhdmFpbGFibGUgYXQgPGh0dHA6Ly9hd3MuYW1hem9uLmNvbS9hZ3JlZW1lbnQ+XG4vLyBvciBvdGhlciB3cml0dGVuIGFncmVlbWVudCBiZXR3ZWVuIEN1c3RvbWVyIGFuZCBlaXRoZXJcbi8vIEFtYXpvbiBXZWIgU2VydmljZXMsIEluYy4gb3IgQW1hem9uIFdlYiBTZXJ2aWNlIEVNRUEgU0FSTCBvciBib3RoLlxuLy8gQ29weXJpZ2h0IDIwMjQgQW1hem9uLmNvbSBhbmQgaXRzIGFmZmlsaWF0ZXM7IGFsbCByaWdodHMgcmVzZXJ2ZWQuXG4vLyBUaGlzIGZpbGUgaXMgQW1hem9uIFdlYiBTZXJ2aWNlcyBDb250ZW50IGFuZCBtYXkgbm90IGJlIGR1cGxpY2F0ZWRcbi8vIG9yIGRpc3RyaWJ1dGVkIHdpdGhvdXQgcGVybWlzc2lvbi5cblxuaW1wb3J0ICogYXMgZnMgZnJvbSAnbm9kZTpmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ25vZGU6cGF0aCc7XG5cbmV4cG9ydCBjb25zdCByZXBsYWNlSW5GaWxlID0gKFxuICBmaWxlUGF0aDogc3RyaW5nLFxuICByZXBsYWNlbWVudHM6IEFycmF5PFtSZWdFeHAsIHN0cmluZ10+LFxuKSA9PiB7XG4gIGxldCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmLTgnKTtcbiAgcmVwbGFjZW1lbnRzLmZvckVhY2goKFtyZWdleCwgcmVwbGFjZW1lbnRdKSA9PiB7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShyZWdleCwgcmVwbGFjZW1lbnQpO1xuICB9KTtcbiAgZnMud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgY29udGVudCk7XG59O1xuXG5leHBvcnQgY29uc3QgcmVuYW1lRmlsZSA9IChmaWxlUGF0aDogc3RyaW5nLCBuZXdGaWxlUGF0aDogc3RyaW5nKSA9PiB7XG4gIGZzLnJlbmFtZVN5bmMoZmlsZVBhdGgsIG5ld0ZpbGVQYXRoKTtcbn07XG5cbmV4cG9ydCBjb25zdCBkZWxldGVGb2xkZXIgPSAoZm9sZGVyUGF0aDogc3RyaW5nKSA9PiB7XG4gIGlmIChmcy5leGlzdHNTeW5jKGZvbGRlclBhdGgpKSB7XG4gICAgZnMucm1TeW5jKGZvbGRlclBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlLCBmb3JjZTogdHJ1ZSB9KTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGNvcHlGaWxlc0FuZEZvbGRlcnMgPSAoXG4gIHNvdXJjZVBhdGg6IHN0cmluZyxcbiAgZGVzdGluYXRpb25QYXRoOiBzdHJpbmcsXG4gIHByb2plY3ROYW1lOiBzdHJpbmcsXG4pID0+IHtcbiAgY29uc3QgTE9XRVJfUFJPSkVDVF9OQU1FID1cbiAgICBwcm9qZWN0TmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIHByb2plY3ROYW1lLnNsaWNlKDEpO1xuICBjb25zdCBVUFBFUl9QUk9KRUNUX05BTUUgPVxuICAgIHByb2plY3ROYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcHJvamVjdE5hbWUuc2xpY2UoMSk7XG5cbiAgLy8gQ3JlYXRlIHRoZSBkZXN0aW5hdGlvbiBkaXJlY3RvcnkgaWYgaXQgZG9lc24ndCBleGlzdFxuICBpZiAoIWZzLmV4aXN0c1N5bmMoZGVzdGluYXRpb25QYXRoKSkge1xuICAgIGZzLm1rZGlyU3luYyhkZXN0aW5hdGlvblBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICB9XG5cbiAgLy8gUmVhZCBhbGwgZmlsZXMgYW5kIGRpcmVjdG9yaWVzIGluIHRoZSBzb3VyY2UgcGF0aFxuICBjb25zdCBGSUxFUyA9IGZzLnJlYWRkaXJTeW5jKHNvdXJjZVBhdGgpO1xuXG4gIGZvciAoY29uc3QgRklMRSBvZiBGSUxFUykge1xuICAgIGNvbnN0IFNSQ19QQVRIID0gcGF0aC5qb2luKHNvdXJjZVBhdGgsIEZJTEUpO1xuICAgIGNvbnN0IFNUQVRTID0gZnMuc3RhdFN5bmMoU1JDX1BBVEgpO1xuXG4gICAgaWYgKFNUQVRTLmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgIGxldCBuZXdGb2xkZXJQYXRoOiBzdHJpbmc7XG4gICAgICBpZiAoRklMRS5pbmNsdWRlcygnJHthcHB9JykpIHtcbiAgICAgICAgY29uc3QgTkVXX0ZPTERFUl9OQU1FID0gRklMRS5yZXBsYWNlKCcke2FwcH0nLCBMT1dFUl9QUk9KRUNUX05BTUUpO1xuICAgICAgICBuZXdGb2xkZXJQYXRoID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgTkVXX0ZPTERFUl9OQU1FKTtcbiAgICAgICAgZGVsZXRlRm9sZGVyKG5ld0ZvbGRlclBhdGgpOyAvLyBEZWxldGUgdGhlIGV4aXN0aW5nIGZvbGRlclxuICAgICAgICBmcy5ta2RpclN5bmMobmV3Rm9sZGVyUGF0aCwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICAgIGNvcHlGaWxlc0FuZEZvbGRlcnMoU1JDX1BBVEgsIG5ld0ZvbGRlclBhdGgsIHByb2plY3ROYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IEZPTERFUl9QQVRIID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgRklMRSk7XG4gICAgICAgIGRlbGV0ZUZvbGRlcihGT0xERVJfUEFUSCk7IC8vIERlbGV0ZSB0aGUgZXhpc3RpbmcgZm9sZGVyXG4gICAgICAgIGZzLm1rZGlyU3luYyhGT0xERVJfUEFUSCwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICAgIGNvcHlGaWxlc0FuZEZvbGRlcnMoU1JDX1BBVEgsIEZPTERFUl9QQVRILCBwcm9qZWN0TmFtZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChTVEFUUy5pc0ZpbGUoKSkge1xuICAgICAgbGV0IG5ld0ZpbGVQYXRoOiBzdHJpbmc7XG4gICAgICBpZiAoRklMRS5pbmNsdWRlcygnJHthcHB9JykpIHtcbiAgICAgICAgbmV3RmlsZVBhdGggPSBwYXRoLmpvaW4oXG4gICAgICAgICAgZGVzdGluYXRpb25QYXRoLFxuICAgICAgICAgIEZJTEUucmVwbGFjZSgnJHthcHB9JywgTE9XRVJfUFJPSkVDVF9OQU1FKSxcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld0ZpbGVQYXRoID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgRklMRSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IFRFTVBfRklMRV9QQVRIID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgYHRlbXBfJHtGSUxFfWApO1xuICAgICAgZnMuY29weUZpbGVTeW5jKFNSQ19QQVRILCBURU1QX0ZJTEVfUEFUSCk7XG5cbiAgICAgIHJlcGxhY2VJbkZpbGUoVEVNUF9GSUxFX1BBVEgsIFtcbiAgICAgICAgWy9cXCR7bmFtZX0vZywgTE9XRVJfUFJPSkVDVF9OQU1FXSxcbiAgICAgICAgWy9cXCR7TmFtZX0vZywgVVBQRVJfUFJPSkVDVF9OQU1FXSxcbiAgICAgIF0pO1xuXG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyhuZXdGaWxlUGF0aCkpIHtcbiAgICAgICAgZnMudW5saW5rU3luYyhuZXdGaWxlUGF0aCk7IC8vIERlbGV0ZSB0aGUgZXhpc3RpbmcgZmlsZVxuICAgICAgfVxuXG4gICAgICBmcy5jb3B5RmlsZVN5bmMoVEVNUF9GSUxFX1BBVEgsIG5ld0ZpbGVQYXRoKTtcbiAgICAgIHJlbmFtZUZpbGUoVEVNUF9GSUxFX1BBVEgsIG5ld0ZpbGVQYXRoKTtcbiAgICB9XG4gIH1cbn07XG4iXX0=