"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.copyFilesAndFolders = exports.deleteFolder = exports.renameFile = exports.replaceInFile = void 0;
const fs = require("node:fs");
const path = require("node:path");
const replaceInFile = (filePath, replacements) => {
    let content = fs.readFileSync(filePath, 'utf-8');
    replacements.forEach(([regex, replacement]) => {
        content = content.replace(regex, replacement);
    });
    fs.writeFileSync(filePath, content);
};
exports.replaceInFile = replaceInFile;
const renameFile = (filePath, newFilePath) => {
    fs.renameSync(filePath, newFilePath);
};
exports.renameFile = renameFile;
const deleteFolder = (folderPath) => {
    if (fs.existsSync(folderPath)) {
        fs.rmSync(folderPath, { recursive: true, force: true });
    }
};
exports.deleteFolder = deleteFolder;
const copyFilesAndFolders = (sourcePath, destinationPath, projectName) => {
    const LOWER_PROJECT_NAME = projectName.charAt(0).toLowerCase() + projectName.slice(1);
    const UPPER_PROJECT_NAME = projectName.charAt(0).toUpperCase() + projectName.slice(1);
    // Create the destination directory if it doesn't exist
    if (!fs.existsSync(destinationPath)) {
        fs.mkdirSync(destinationPath, { recursive: true });
    }
    // Read all files and directories in the source path
    const FILES = fs.readdirSync(sourcePath);
    for (const FILE of FILES) {
        const SRC_PATH = path.join(sourcePath, FILE);
        const STATS = fs.statSync(SRC_PATH);
        if (STATS.isDirectory()) {
            let newFolderPath;
            if (FILE.includes('${app}')) {
                const NEW_FOLDER_NAME = FILE.replace('${app}', LOWER_PROJECT_NAME);
                newFolderPath = path.join(destinationPath, NEW_FOLDER_NAME);
                deleteFolder(newFolderPath); // Delete the existing folder
                fs.mkdirSync(newFolderPath, { recursive: true });
                copyFilesAndFolders(SRC_PATH, newFolderPath, projectName);
            }
            else {
                const FOLDER_PATH = path.join(destinationPath, FILE);
                deleteFolder(FOLDER_PATH); // Delete the existing folder
                fs.mkdirSync(FOLDER_PATH, { recursive: true });
                copyFilesAndFolders(SRC_PATH, FOLDER_PATH, projectName);
            }
        }
        else if (STATS.isFile()) {
            let newFilePath;
            if (FILE.includes('${app}')) {
                newFilePath = path.join(destinationPath, FILE.replace('${app}', LOWER_PROJECT_NAME));
            }
            else {
                newFilePath = path.join(destinationPath, FILE);
            }
            const TEMP_FILE_PATH = path.join(destinationPath, `temp_${FILE}`);
            fs.copyFileSync(SRC_PATH, TEMP_FILE_PATH);
            replaceInFile(TEMP_FILE_PATH, [
                [/\${name}/g, LOWER_PROJECT_NAME],
                [/\${Name}/g, UPPER_PROJECT_NAME],
            ]);
            if (fs.existsSync(newFilePath)) {
                fs.unlinkSync(newFilePath); // Delete the existing file
            }
            fs.copyFileSync(TEMP_FILE_PATH, newFilePath);
            renameFile(TEMP_FILE_PATH, newFilePath);
        }
    }
};
exports.copyFilesAndFolders = copyFilesAndFolders;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVwbGFjZVBsYWNlaG9sZGVycy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXBsYWNlUGxhY2Vob2xkZXJzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDhCQUE4QjtBQUM5QixrQ0FBa0M7QUFFbEMsTUFBTSxhQUFhLEdBQUcsQ0FDcEIsUUFBZ0IsRUFDaEIsWUFBcUMsRUFDckMsRUFBRTtJQUNGLElBQUksT0FBTyxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0lBQ2pELFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsRUFBRSxFQUFFO1FBQzVDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxXQUFXLENBQUMsQ0FBQztJQUNoRCxDQUFDLENBQUMsQ0FBQztJQUNILEVBQUUsQ0FBQyxhQUFhLENBQUMsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3RDLENBQUMsQ0FBQztBQTZFTyxzQ0FBYTtBQTNFdEIsTUFBTSxVQUFVLEdBQUcsQ0FBQyxRQUFnQixFQUFFLFdBQW1CLEVBQUUsRUFBRTtJQUMzRCxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxXQUFXLENBQUMsQ0FBQztBQUN2QyxDQUFDLENBQUM7QUF5RXNCLGdDQUFVO0FBdkVsQyxNQUFNLFlBQVksR0FBRyxDQUFDLFVBQWtCLEVBQUUsRUFBRTtJQUMxQyxJQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQztRQUM5QixFQUFFLENBQUMsTUFBTSxDQUFDLFVBQVUsRUFBRSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDMUQsQ0FBQztBQUNILENBQUMsQ0FBQztBQW1Fa0Msb0NBQVk7QUFqRWhELE1BQU0sbUJBQW1CLEdBQUcsQ0FDMUIsVUFBa0IsRUFD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LEVBQUUsa0JBQWtCLENBQUM7Z0JBQ2pDLENBQUMsV0FBVyxFQUFFLGtCQUFrQixDQUFDO2FBQ2xDLENBQUMsQ0FBQztZQUVILElBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLENBQUMsRUFBRSxDQUFDO2dCQUMvQixFQUFFLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsMkJBQTJCO1lBQ3pELENBQUM7WUFFRCxFQUFFLENBQUMsWUFBWSxDQUFDLGNBQWMsRUFBRSxXQUFXLENBQUMsQ0FBQztZQUM3QyxVQUFVLENBQUMsY0FBYyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1FBQzFDLENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRWdELGtEQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGZzIGZyb20gJ25vZGU6ZnMnO1xuaW1wb3J0ICogYXMgcGF0aCBmcm9tICdub2RlOnBhdGgnO1xuXG5jb25zdCByZXBsYWNlSW5GaWxlID0gKFxuICBmaWxlUGF0aDogc3RyaW5nLFxuICByZXBsYWNlbWVudHM6IEFycmF5PFtSZWdFeHAsIHN0cmluZ10+LFxuKSA9PiB7XG4gIGxldCBjb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKGZpbGVQYXRoLCAndXRmLTgnKTtcbiAgcmVwbGFjZW1lbnRzLmZvckVhY2goKFtyZWdleCwgcmVwbGFjZW1lbnRdKSA9PiB7XG4gICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShyZWdleCwgcmVwbGFjZW1lbnQpO1xuICB9KTtcbiAgZnMud3JpdGVGaWxlU3luYyhmaWxlUGF0aCwgY29udGVudCk7XG59O1xuXG5jb25zdCByZW5hbWVGaWxlID0gKGZpbGVQYXRoOiBzdHJpbmcsIG5ld0ZpbGVQYXRoOiBzdHJpbmcpID0+IHtcbiAgZnMucmVuYW1lU3luYyhmaWxlUGF0aCwgbmV3RmlsZVBhdGgpO1xufTtcblxuY29uc3QgZGVsZXRlRm9sZGVyID0gKGZvbGRlclBhdGg6IHN0cmluZykgPT4ge1xuICBpZiAoZnMuZXhpc3RzU3luYyhmb2xkZXJQYXRoKSkge1xuICAgIGZzLnJtU3luYyhmb2xkZXJQYXRoLCB7IHJlY3Vyc2l2ZTogdHJ1ZSwgZm9yY2U6IHRydWUgfSk7XG4gIH1cbn07XG5cbmNvbnN0IGNvcHlGaWxlc0FuZEZvbGRlcnMgPSAoXG4gIHNvdXJjZVBhdGg6IHN0cmluZyxcbiAgZGVzdGluYXRpb25QYXRoOiBzdHJpbmcsXG4gIHByb2plY3ROYW1lOiBzdHJpbmcsXG4pID0+IHtcbiAgY29uc3QgTE9XRVJfUFJPSkVDVF9OQU1FID1cbiAgICBwcm9qZWN0TmFtZS5jaGFyQXQoMCkudG9Mb3dlckNhc2UoKSArIHByb2plY3ROYW1lLnNsaWNlKDEpO1xuICBjb25zdCBVUFBFUl9QUk9KRUNUX05BTUUgPVxuICAgIHByb2plY3ROYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcHJvamVjdE5hbWUuc2xpY2UoMSk7XG5cbiAgLy8gQ3JlYXRlIHRoZSBkZXN0aW5hdGlvbiBkaXJlY3RvcnkgaWYgaXQgZG9lc24ndCBleGlzdFxuICBpZiAoIWZzLmV4aXN0c1N5bmMoZGVzdGluYXRpb25QYXRoKSkge1xuICAgIGZzLm1rZGlyU3luYyhkZXN0aW5hdGlvblBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICB9XG5cbiAgLy8gUmVhZCBhbGwgZmlsZXMgYW5kIGRpcmVjdG9yaWVzIGluIHRoZSBzb3VyY2UgcGF0aFxuICBjb25zdCBGSUxFUyA9IGZzLnJlYWRkaXJTeW5jKHNvdXJjZVBhdGgpO1xuXG4gIGZvciAoY29uc3QgRklMRSBvZiBGSUxFUykge1xuICAgIGNvbnN0IFNSQ19QQVRIID0gcGF0aC5qb2luKHNvdXJjZVBhdGgsIEZJTEUpO1xuICAgIGNvbnN0IFNUQVRTID0gZnMuc3RhdFN5bmMoU1JDX1BBVEgpO1xuXG4gICAgaWYgKFNUQVRTLmlzRGlyZWN0b3J5KCkpIHtcbiAgICAgIGxldCBuZXdGb2xkZXJQYXRoOiBzdHJpbmc7XG4gICAgICBpZiAoRklMRS5pbmNsdWRlcygnJHthcHB9JykpIHtcbiAgICAgICAgY29uc3QgTkVXX0ZPTERFUl9OQU1FID0gRklMRS5yZXBsYWNlKCcke2FwcH0nLCBMT1dFUl9QUk9KRUNUX05BTUUpO1xuICAgICAgICBuZXdGb2xkZXJQYXRoID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgTkVXX0ZPTERFUl9OQU1FKTtcbiAgICAgICAgZGVsZXRlRm9sZGVyKG5ld0ZvbGRlclBhdGgpOyAvLyBEZWxldGUgdGhlIGV4aXN0aW5nIGZvbGRlclxuICAgICAgICBmcy5ta2RpclN5bmMobmV3Rm9sZGVyUGF0aCwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICAgIGNvcHlGaWxlc0FuZEZvbGRlcnMoU1JDX1BBVEgsIG5ld0ZvbGRlclBhdGgsIHByb2plY3ROYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IEZPTERFUl9QQVRIID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgRklMRSk7XG4gICAgICAgIGRlbGV0ZUZvbGRlcihGT0xERVJfUEFUSCk7IC8vIERlbGV0ZSB0aGUgZXhpc3RpbmcgZm9sZGVyXG4gICAgICAgIGZzLm1rZGlyU3luYyhGT0xERVJfUEFUSCwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICAgIGNvcHlGaWxlc0FuZEZvbGRlcnMoU1JDX1BBVEgsIEZPTERFUl9QQVRILCBwcm9qZWN0TmFtZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChTVEFUUy5pc0ZpbGUoKSkge1xuICAgICAgbGV0IG5ld0ZpbGVQYXRoOiBzdHJpbmc7XG4gICAgICBpZiAoRklMRS5pbmNsdWRlcygnJHthcHB9JykpIHtcbiAgICAgICAgbmV3RmlsZVBhdGggPSBwYXRoLmpvaW4oXG4gICAgICAgICAgZGVzdGluYXRpb25QYXRoLFxuICAgICAgICAgIEZJTEUucmVwbGFjZSgnJHthcHB9JywgTE9XRVJfUFJPSkVDVF9OQU1FKSxcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld0ZpbGVQYXRoID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgRklMRSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IFRFTVBfRklMRV9QQVRIID0gcGF0aC5qb2luKGRlc3RpbmF0aW9uUGF0aCwgYHRlbXBfJHtGSUxFfWApO1xuICAgICAgZnMuY29weUZpbGVTeW5jKFNSQ19QQVRILCBURU1QX0ZJTEVfUEFUSCk7XG5cbiAgICAgIHJlcGxhY2VJbkZpbGUoVEVNUF9GSUxFX1BBVEgsIFtcbiAgICAgICAgWy9cXCR7bmFtZX0vZywgTE9XRVJfUFJPSkVDVF9OQU1FXSxcbiAgICAgICAgWy9cXCR7TmFtZX0vZywgVVBQRVJfUFJPSkVDVF9OQU1FXSxcbiAgICAgIF0pO1xuXG4gICAgICBpZiAoZnMuZXhpc3RzU3luYyhuZXdGaWxlUGF0aCkpIHtcbiAgICAgICAgZnMudW5saW5rU3luYyhuZXdGaWxlUGF0aCk7IC8vIERlbGV0ZSB0aGUgZXhpc3RpbmcgZmlsZVxuICAgICAgfVxuXG4gICAgICBmcy5jb3B5RmlsZVN5bmMoVEVNUF9GSUxFX1BBVEgsIG5ld0ZpbGVQYXRoKTtcbiAgICAgIHJlbmFtZUZpbGUoVEVNUF9GSUxFX1BBVEgsIG5ld0ZpbGVQYXRoKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCB7IHJlcGxhY2VJbkZpbGUsIHJlbmFtZUZpbGUsIGRlbGV0ZUZvbGRlciwgY29weUZpbGVzQW5kRm9sZGVycyB9O1xuIl19